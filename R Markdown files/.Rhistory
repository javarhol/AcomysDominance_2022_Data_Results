Hour_num==23 ~ 3,
Hour_num==0 ~ 4,
Hour_num==1 ~ 5,
Hour_num==2 ~ 6,
Hour_num==3 ~ 7,
Hour_num==4 ~ 8,
Hour_num==5 ~ 9))
head(sexdyads)
sexdyads <- sexdyads %>%
mutate(!!!as.data.frame(poly(adjhour, degree=2, raw=TRUE))) %>%
setNames(c("Cage", "Sex", "GrpSize", "Age", "Date", "Hour", "Hour_chr", "Behavior", "n", "prop", "Day", "Hour_num", "adjhour", "ot1", "ot2"))
sexdyads <- sexdyads %>%
mutate(!!!as.data.frame(poly(.$adjhour, degree=2, raw=TRUE))) %>%
setNames(c("Cage", "Sex", "GrpSize", "Age", "Date", "Hour", "Hour_chr", "Behavior", "n", "prop", "Day", "Hour_num", "adjhour", "ot1", "ot2"))
View(sexdyads)
poly(4, 2)
poly(1:10, 2)
sexdyads <- nightag_1 %>%
filter(GrpSize==2) %>%
filter(Age=="Young") %>%
filter(Behavior=="Chasing")
ggplot(sexdyads, aes(Hour_chr, prop, shape=Sex, group=Sex))+
stat_summary(fun.y=mean, geom="line", size=1)+
stat_summary(fun.data=mean_se, geom="pointrange", size=1)
sexdyads$Hour_num <- sub("^0", "", sexdyads$Hour_chr)
sexdyads$Hour_num <- as.numeric(sexdyads$Hour_num)
sexdyads <- mutate(sexdyads, adjhour=case_when(Hour_num==20 ~ 0,
Hour_num==21 ~ 1,
Hour_num==22 ~ 2,
Hour_num==23 ~ 3,
Hour_num==0 ~ 4,
Hour_num==1 ~ 5,
Hour_num==2 ~ 6,
Hour_num==3 ~ 7,
Hour_num==4 ~ 8,
Hour_num==5 ~ 9))
sexdyads <- sexdyads %>%
mutate(!!!as.data.frame(poly(.$adjhour, degree=2))) %>%
setNames(c("Cage", "Sex", "GrpSize", "Age", "Date", "Hour", "Hour_chr", "Behavior", "n", "prop", "Day", "Hour_num", "adjhour", "ot1", "ot2"))
View(sexdyads)
m.base <- lmer(prop ~ (ot1+ot2) + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.0 <- lmer(prop ~ (ot1+ot2) + adjhour + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.1 <- lmer(prop ~ (ot1+ot2) + adjhour + ot1:adjhour + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.2 <- lmer(prop ~ (ot1+ot2)*adjhour + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
anova(m.base, m.0, m.1, m.2)
m.base <- lmer(prop ~ (ot1+ot2) + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.0 <- lmer(prop ~ (ot1+ot2) + Sex + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.1 <- lmer(prop ~ (ot1+ot2) + Sex + ot1:Sex + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.2 <- lmer(prop ~ (ot1+ot2)*Sex + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
anova(m.base, m.0, m.1, m.2)
m.x <- lm(prop ~ (ot1+ot2)*Sex, data=sexdyads)
anova(m.base, m.0, m.1, m.2, m.x)
anova(m.base, m.0, m.1, m.2)
sexdyads <- nightag_1 %>%
filter(GrpSize==2) %>%
filter(Age=="Young") %>%
filter(Behavior=="Chasing")
ggplot(sexdyads, aes(Hour_chr, prop, shape=Sex, group=Sex))+
stat_summary(fun.y=mean, geom="line", size=1)+
stat_summary(fun.data=mean_se, geom="pointrange", size=1)
sexdyads$Hour_num <- sub("^0", "", sexdyads$Hour_chr)
sexdyads$Hour_num <- as.numeric(sexdyads$Hour_num)
sexdyads <- mutate(sexdyads, adjhour=case_when(Hour_num==20 ~ 0,
Hour_num==21 ~ 1,
Hour_num==22 ~ 2,
Hour_num==23 ~ 3,
Hour_num==0 ~ 4,
Hour_num==1 ~ 5,
Hour_num==2 ~ 6,
Hour_num==3 ~ 7,
Hour_num==4 ~ 8,
Hour_num==5 ~ 9))
sexdyads <- sexdyads %>%
mutate(!!!as.data.frame(poly(.$adjhour, degree=4))) %>%
setNames(c("Cage", "Sex", "GrpSize", "Age", "Date", "Hour", "Hour_chr", "Behavior", "n", "prop", "Day", "Hour_num", "adjhour", "ot1", "ot2","ot3","ot4"))
m.base <- lmer(prop ~ (ot1+ot2+ot3+ot4) + (ot1+ot2+ot3+ot4 | Cage), data=sexdyads, REML=FALSE)
m.1 <- lmer(prop ~ (ot1+ot2+ot3+ot4) + Sex + ot1:Sex + (ot1+ot2+ot3+ot4 | Cage), data=sexdyads, REML=FALSE)
m.2 <- lmer(prop ~ (ot1+ot2+ot3+ot4)*Sex + (ot1+ot2+ot3+ot4 | Cage), data=sexdyads, REML=FALSE)
anova(m.base, m.0, m.1, m.2)
m.base <- lmer(prop ~ (ot1+ot2) + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.0 <- lmer(prop ~ (ot1+ot2) + Sex + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.1 <- lmer(prop ~ (ot1+ot2) + Sex + ot1:Sex + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
m.2 <- lmer(prop ~ (ot1+ot2)*Sex + (ot1+ot2 | Cage), data=sexdyads, REML=FALSE)
anova(m.base, m.0, m.1, m.2)
m.x <- lm(prop ~ adjhour*Sex + (adjhour | Cage), data=sexdyads)
m.x <- lmer(prop ~ adjhour*Sex + (adjhour | Cage), data=sexdyads, REML=FALSE)
anova(m.base, m.0, m.1, m.2, m.x)
anova(m.base)
anova(m.0)
ggplot(sexdyads, aes(adjhour, prop, shape=Sex, group=Sex))+
stat_summary(aes(y=fitted(m.0), linetype=Sex), fun.y=mean, geom="line", size=1)+
stat_summary(fun.data=mean_se, geom="pointrange", size=1)
ggplot(sexdyads, aes(adjhour, prop, shape=Sex, group=Sex))+
stat_summary(aes(y=fitted(m.2), linetype=Sex), fun.y=mean, geom="line", size=1)+
stat_summary(fun.data=mean_se, geom="pointrange", size=1)
View(sexdyads)
writeClipboard(sexdyads)
?write.csv()
write.csv(sexdyad, "/Users/justinvarholick/Desktop/data.csv")
write.csv(sexdyads, "/Users/justinvarholick/Desktop/data.csv")
head(sexdyads)
sexdyads_2 <- sexdyads %>%
select(Cage, Day, adjhour, prop) %>%
spread(adjhour, prop)
write.csv(sexdyads, "/Users/justinvarholick/Desktop/data.csv")
write.csv(sexdyads,_2 "/Users/justinvarholick/Desktop/data.csv")
write.csv(sexdyads_2, "/Users/justinvarholick/Desktop/data.csv")
male_dyads<- nightag_1 %>%
filter(GrpSize==2) %>%
filter(Age=="Young") %>%
filter(Sex=="M")
ggplot(male_dyads, aes(Behavior, prop))+
geom_boxplot()
head(nightag_1)
grouped_data <- nightag_1 %>%
group_by(Cage, Sex, GrpSize, Age, Day, Behavior) %>%
summarise(total_minutes=sum(n))
head(grouped_n)
head(grouped_data)
grouped_data_day <- nightag_1 %>%
group_by(Cage, Sex, GrpSize, Age, Day, Behavior) %>%
summarise(total_minutes_day=sum(n))
grouped_data_cage <- nightag_1 %>%
group_by(Cage, Sex, GrpSize, Age, Behavior) %>%
summarise(total_minutes_cage=sum(n))
View(grouped_data_cage)
View(grouped_data_cage)
ggplot(male_dyads, aes(Behavior, total_minutes_cage))+
geom_boxplot()
male_dyads<- grouped_data_cage %>%
filter(GrpSize==2) %>%
filter(Age=="Young") %>%
filter(Sex=="M")
ggplot(male_dyads, aes(Behavior, total_minutes_cage))+
geom_boxplot()
grouped_data_day <- nightag_1 %>%
group_by(Cage, Sex, GrpSize, Age, Day, Behavior) %>%
summarise(total_minutes_day=sum(n)) %>%
mutate(prop_day=(total_minutes_day/150))
grouped_data_cage <- nightag_1 %>%
group_by(Cage, Sex, GrpSize, Age, Behavior) %>%
summarise(total_minutes_cage=sum(n)) %>%
mutate(prop_cage=(total_minutes_cage/1350))
male_dyads<- grouped_data_cage %>%
filter(GrpSize==2) %>%
filter(Age=="Young") %>%
filter(Sex=="M")
ggplot(male_dyads, aes(Behavior, prop_cage))+
geom_boxplot()
ggplot(male_dyads, aes(Behavior, prop_cage))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))
ggplot(male_dyads, aes(Behavior, prop_cage))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
facet_wrap(~Cage)
sex_dyads<- grouped_data_cage %>%
filter(GrpSize==2) %>%
filter(Age=="Young")
ggplot(sex_dyads, aes(Behavior, prop_cage))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
facet_wrap(~Sex)
ggplot(sex_dyads, aes(Behavior, prop_cage, fill=Sex))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))
ggplot(sex_dyads, aes(Behavior, prop_cage, fill=Sex))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
scale_fill_npg()
sex_dyads<- grouped_data_cage %>%
filter(GrpSize==2) %>%
filter(Age=="Young") %>%
filter(Behavior!="Mounting (active)")
ggplot(sex_dyads, aes(Behavior, prop_cage, fill=Sex))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
scale_fill_npg()
males<- grouped_data_cage %>%
filter(Sex=="M") %>%
filter(Behavior!="Mounting (active)")
ggplot(males, aes(Behavior, prop_cage, fill=GrpSize))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
scale_fill_npg()
ggplot(males, aes(Behavior, prop_cage, fill=as.factor(GrpSize)))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
scale_fill_npg()
females<- grouped_data_cage %>%
filter(Sex=="F") %>%
filter(Behavior!="Mounting (active)")
ggplot(females, aes(Behavior, prop_cage, fill=Age))+
geom_boxplot()+
scale_y_continuous(limits = c(0,1))+
scale_fill_npg()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(readxl)
raw_data <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qPCR_data_dominance1.xlsx", sheet="DuplicatedRuns_Removed")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(readxl)
raw_data <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qPCR_data_dominance1.xlsx", sheet="DuplicatedRuns_Removed")
View(raw_data)
raw_data2 <- raw_data %>%
group_by(target, Sample) %>%
mutate(num_dups=n(),
dup_id=row_number()) %>%
ungroup() %>%
mutate(isduplicated=dup_id > 1)
tidy_data <- raw_data %>%
filter(Sample!="NTC", Sample!="") %>%
mutate(Cq=as.numeric(Cq)) %>%
mutate(logCq= log(Cq)) %>%
group_by(plate, Sample, target) %>%
summarise(mean_Ct = mean(logCq))
test_data <- tidy_data %>%
filter(Sample!="Calibrator")
calibrators <- tidy_data %>%
filter(Sample=="Calibrator")
cal_tidy <- left_join(test_data, calibrators, by=c("plate"))
cal_tidy <- mutate(cal_tidy, calb_Ct = mean_Ct.y - mean_Ct.x)
tidy_data_calCt <- cal_tidy %>%
data.frame() %>%
mutate(target=target.x) %>%
select(Sample.x, target, calb_Ct)
head(tidy_data_calCt)
primer_effis <- read_xlsx("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qPCR_primer_effis_converted.xlsx")
tidy_data_calCt_eff <- left_join(tidy_data_calCt, primer_effis, by="target")
tidy_data_calCt_eff <- tidy_data_calCt_eff %>%
mutate(eff_Ct = conv_effi^(calb_Ct))
head(tidy_data_calCt_eff)
test_data <- tidy_data_calCt_eff %>%
filter(target!="Actin B")
ActinB <- tidy_data_calCt_eff %>%
filter(target=="Actin B")
HK_tidy <- left_join(test_data, ActinB, by=c("Sample.x"))
HK_tidy <- mutate(HK_tidy, GeneExpRat = eff_Ct.x / eff_Ct.y)
tidy_data_pfaffl <- HK_tidy %>%
data.frame() %>%
select(Sample.x, target.x, GeneExpRat)
head(tidy_data_pfaffl)
inv_data <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx")
tidy_inv_data <- inv_data[,c(1,2,5,6,7,8)]
tidy_data_pfaffl <- rename(tidy_data_pfaffl, BlindID = Sample.x)
tidy_data_pfaffl2 <- left_join(tidy_data_pfaffl, tidy_inv_data, by="BlindID")
head(tidy_data_pfaffl2)
write.csv(tidy_data_pfaffl2, "/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_082922.csv")
knitr::opts_chunk$set(echo = TRUE)
#plots
library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(ggpubr)
library(cowplot)
library(readxl)
#stats
library(psych)
library(lme4)
library(lmerTest)
library(MuMIn)
ggthemr('flat')
qpcr_data <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_040122.csv")
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
ind_ds <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
eardata <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/EarDaysToClose.xlsx")
stability <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/stabilitybycage.csv")
qpcr_data <- left_join(qpcr_data, sex_id[,c(4,6,15)], by="AnimalID")
qpcr_data <- left_join(qpcr_data, ind_ds[,2:5], by="AnimalID")
qpcr_data <- left_join(qpcr_data, eardata, by="AnimalID")
qpcr_data <- left_join(qpcr_data, stability, by="AnimalID")
qpcr_data$Sex <- as.factor(qpcr_data$Sex)
qpcr_data$Cage.x <- as.factor(qpcr_data$Cage.x)
qpcr_data$GrpSize <- as.factor(qpcr_data$GrpSize)
qpcr_data$dom_status_ds <- as.factor(qpcr_data$dom_status_ds)
qpcr_data$stab_status <- factor(qpcr_data$stab_status, levels=c("Stable", "Unstable", "Unclear"))
Cyp11a1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Cyp11a1"), REML=TRUE)
Star_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="StAR"), REML=TRUE)
Nr5a1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Nrb01"), REML=TRUE)
Nrb01_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Nr5a1"), REML=TRUE)
Cyp11b1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Cyp11b1"), REML=TRUE)
print("Cyp11a1")
anova(Cyp11a1_m_f)
r.squaredGLMM(Cyp11a1_m_f)
print("Star")
anova(Star_m_f)
r.squaredGLMM(Star_m_f)
print("Nr5a1")
anova(Nr5a1_m_f)
summary(Nr5a1_m_f)
r.squaredGLMM(Nr5a1_m_f)
print("Nrb01")
anova(Nrb01_m_f)
r.squaredGLMM(Nrb01_m_f)
print("Cyp11b1")
anova(Cyp11b1_m_f)
r.squaredGLMM(Cyp11b1_m_f)
summary(Cyp11b1_m_f)
cyp11b1 <- qpcr_data %>%
filter(target.x != "GAPDH")
cyp_plot <- ggplot(cyp11b1, aes(target.x, GeneExpRat, fill=Sex, color=Sex))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("") + ylab("Gene expression ratio")
cyp_plot
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(readxl)
raw_data <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qPCR_data_dominance1.xlsx", sheet="DuplicatedRuns_Removed")
raw_data2 <- raw_data %>%
group_by(target, Sample) %>%
mutate(num_dups=n(),
dup_id=row_number()) %>%
ungroup() %>%
mutate(isduplicated=dup_id > 1)
tidy_data <- raw_data %>%
filter(Sample!="NTC", Sample!="") %>%
mutate(Cq=as.numeric(Cq)) %>%
mutate(logCq= log(Cq)) %>%
group_by(plate, Sample, target) %>%
summarise(mean_Ct = mean(logCq))
test_data <- tidy_data %>%
filter(Sample!="Calibrator")
calibrators <- tidy_data %>%
filter(Sample=="Calibrator")
cal_tidy <- left_join(test_data, calibrators, by=c("plate"))
cal_tidy <- mutate(cal_tidy, calb_Ct = mean_Ct.y - mean_Ct.x)
tidy_data_calCt <- cal_tidy %>%
data.frame() %>%
mutate(target=target.x) %>%
select(Sample.x, target, calb_Ct)
head(tidy_data_calCt)
primer_effis <- read_xlsx("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qPCR_primer_effis_converted.xlsx")
tidy_data_calCt_eff <- left_join(tidy_data_calCt, primer_effis, by="target")
tidy_data_calCt_eff <- tidy_data_calCt_eff %>%
mutate(eff_Ct = conv_effi^(calb_Ct))
head(tidy_data_calCt_eff)
test_data <- tidy_data_calCt_eff %>%
filter(target!="Actin B")
ActinB <- tidy_data_calCt_eff %>%
filter(target=="Actin B")
HK_tidy <- left_join(test_data, ActinB, by=c("Sample.x"))
HK_tidy <- mutate(HK_tidy, GeneExpRat = eff_Ct.x / eff_Ct.y)
tidy_data_pfaffl <- HK_tidy %>%
data.frame() %>%
select(Sample.x, target.x, GeneExpRat)
head(tidy_data_pfaffl)
inv_data <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx")
tidy_inv_data <- inv_data[,c(1,2,5,6,7,8)]
tidy_data_pfaffl <- rename(tidy_data_pfaffl, BlindID = Sample.x)
tidy_data_pfaffl2 <- left_join(tidy_data_pfaffl, tidy_inv_data, by="BlindID")
head(tidy_data_pfaffl2)
write.csv(tidy_data_pfaffl2, "/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_082922.csv")
knitr::opts_chunk$set(echo = TRUE)
#plots
library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(ggpubr)
library(cowplot)
library(readxl)
#stats
library(psych)
library(lme4)
library(lmerTest)
library(MuMIn)
ggthemr('flat')
qpcr_data <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_040122.csv")
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
ind_ds <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
eardata <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/EarDaysToClose.xlsx")
stability <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/stabilitybycage.csv")
qpcr_data <- left_join(qpcr_data, sex_id[,c(4,6,15)], by="AnimalID")
qpcr_data <- left_join(qpcr_data, ind_ds[,2:5], by="AnimalID")
qpcr_data <- left_join(qpcr_data, eardata, by="AnimalID")
qpcr_data <- left_join(qpcr_data, stability, by="AnimalID")
qpcr_data$Sex <- as.factor(qpcr_data$Sex)
qpcr_data$Cage.x <- as.factor(qpcr_data$Cage.x)
qpcr_data$GrpSize <- as.factor(qpcr_data$GrpSize)
qpcr_data$dom_status_ds <- as.factor(qpcr_data$dom_status_ds)
qpcr_data$stab_status <- factor(qpcr_data$stab_status, levels=c("Stable", "Unstable", "Unclear"))
Cyp11a1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Cyp11a1"), REML=TRUE)
Star_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="StAR"), REML=TRUE)
Nr5a1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Nrb01"), REML=TRUE)
Nrb01_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Nr5a1"), REML=TRUE)
Cyp11b1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Cyp11b1"), REML=TRUE)
print("Cyp11a1")
anova(Cyp11a1_m_f)
r.squaredGLMM(Cyp11a1_m_f)
print("Star")
anova(Star_m_f)
r.squaredGLMM(Star_m_f)
print("Nr5a1")
anova(Nr5a1_m_f)
summary(Nr5a1_m_f)
r.squaredGLMM(Nr5a1_m_f)
print("Nrb01")
anova(Nrb01_m_f)
r.squaredGLMM(Nrb01_m_f)
print("Cyp11b1")
anova(Cyp11b1_m_f)
r.squaredGLMM(Cyp11b1_m_f)
summary(Cyp11b1_m_f)
cyp11b1 <- qpcr_data %>%
filter(target.x != "GAPDH")
cyp_plot <- ggplot(cyp11b1, aes(target.x, GeneExpRat, fill=Sex, color=Sex))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("") + ylab("Gene expression ratio")
cyp_plot
cyp11b1 <- qpcr_data %>%
filter(target.x != "GAPDH")
cyp_plot <- ggplot(cyp11b1, aes(target.x, GeneExpRat, fill=Sex, color=Sex))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("") + ylab("Gene expression ratio")
cyp_plot
View(cyp11b1)
View(cyp11b1)
View(cyp11b1)
knitr::opts_chunk$set(echo = TRUE)
#plots
library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(ggpubr)
library(cowplot)
library(readxl)
#stats
library(psych)
library(lme4)
library(lmerTest)
library(MuMIn)
ggthemr('flat')
qpcr_data <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_082922.csv")
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
ind_ds <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
eardata <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/EarDaysToClose.xlsx")
stability <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/stabilitybycage.csv")
qpcr_data <- left_join(qpcr_data, sex_id[,c(4,6,15)], by="AnimalID")
qpcr_data <- left_join(qpcr_data, ind_ds[,2:5], by="AnimalID")
qpcr_data <- left_join(qpcr_data, eardata, by="AnimalID")
qpcr_data <- left_join(qpcr_data, stability, by="AnimalID")
qpcr_data$Sex <- as.factor(qpcr_data$Sex)
qpcr_data$Cage.x <- as.factor(qpcr_data$Cage.x)
qpcr_data$GrpSize <- as.factor(qpcr_data$GrpSize)
qpcr_data$dom_status_ds <- as.factor(qpcr_data$dom_status_ds)
qpcr_data$stab_status <- factor(qpcr_data$stab_status, levels=c("Stable", "Unstable", "Unclear"))
Cyp11a1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Cyp11a1"), REML=TRUE)
Star_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="StAR"), REML=TRUE)
Nr5a1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Nrb01"), REML=TRUE)
Nrb01_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Nr5a1"), REML=TRUE)
Cyp11b1_m_f <- lmer(GeneExpRat ~  (1|Cage.x) + Sex + ds + stab_status + ds*stab_status, filter(qpcr_data, target.x=="Cyp11b1"), REML=TRUE)
print("Cyp11a1")
anova(Cyp11a1_m_f)
r.squaredGLMM(Cyp11a1_m_f)
print("Star")
anova(Star_m_f)
r.squaredGLMM(Star_m_f)
print("Nr5a1")
anova(Nr5a1_m_f)
summary(Nr5a1_m_f)
r.squaredGLMM(Nr5a1_m_f)
print("Nrb01")
anova(Nrb01_m_f)
r.squaredGLMM(Nrb01_m_f)
print("Cyp11b1")
anova(Cyp11b1_m_f)
r.squaredGLMM(Cyp11b1_m_f)
summary(Cyp11b1_m_f)
cyp11b1 <- qpcr_data %>%
filter(target.x != "GAPDH")
cyp_plot <- ggplot(cyp11b1, aes(target.x, GeneExpRat, fill=Sex, color=Sex))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("") + ylab("Gene expression ratio")
cyp_plot
Nr5a1 <- qpcr_data %>%
filter(target.x == "Nr5a1")
Nr_plot <- ggplot(Nr5a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=4)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1.5)+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Gene expression ratio \nNr5a1")+
labs(color="Stability")
Nr_plot
qplot <- plot_grid(
cyp_plot, Nr_plot,
labels="AUTO", ncol=1, align="v"
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots.tiff", qplot, units="cm", width = 15, height = 15, device='tiff', dpi=300)
qplot
View(qpcr_data)

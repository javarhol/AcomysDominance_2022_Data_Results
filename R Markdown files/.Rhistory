show_col(pal_npg()(6))
grp_plot <- ggplot(males, aes(Behavior, prop_cage, fill=as.factor(GrpSize), color=as.factor(GrpSize)))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.5), binwidth = 0.05)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.5))+
scale_y_continuous(limits = c(0,1))+
scale_color_manual(values=c("#00A087FF", "#3C5488FF"))+
scale_fill_manual(values=c("#00A087FF", "#3C5488FF"))+
ylab("proportion of \nbehavior per cage") + xlab("")+
guides(fill=guide_legend("Group Size"), color=guide_legend("Group Size"))
age_plot <- ggplot(females, aes(Behavior, prop_cage, fill=Age, color=Age))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.5), binwidth = 0.05)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.5))+
scale_y_continuous(limits = c(0,1))+
scale_color_manual(values=c("#F39B7FFF", "#8491B4FF"))+
scale_fill_manual(values=c("#F39B7FFF", "#8491B4FF"))+
ylab("proportion of \nbehavior per cage") + xlab("")+
labs(fill="Age", color="Age")
fig4 <- plot_grid(
grp_plot, age_plot,
labels="AUTO", ncol=1, align="v"
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig4_nightbhv_plots.tiff", fig4, units="in", width = 6.5, height = 4, device='tiff', dpi=300)
fig4
grp_plot <- ggplot(males, aes(Behavior, prop_cage, fill=as.factor(GrpSize), color=as.factor(GrpSize)))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.5), binwidth = 0.05)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.5))+
scale_y_continuous(limits = c(0,1))+
scale_color_manual(values=c("#00A087FF", "#3C5488FF"))+
scale_fill_manual(values=c("#00A087FF", "#3C5488FF"))+
ylab("proportion of \nbehavior per cage") + xlab("")+
guides(fill=guide_legend("Group Size"), color=guide_legend("Group Size"))
age_plot <- ggplot(females, aes(Behavior, prop_cage, fill=Age, color=Age))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.5), binwidth = 0.05)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.5))+
scale_y_continuous(limits = c(0,1))+
scale_color_manual(values=c("#F39B7FFF", "#8491B4FF"))+
scale_fill_manual(values=c("#F39B7FFF", "#8491B4FF"))+
ylab("proportion of \nbehavior per cage") + xlab("")+
labs(fill="Age", color="Age")
fig4 <- plot_grid(
grp_plot, age_plot,
labels="AUTO", ncol=1, align="v"
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig4_nightbhv_plots.tiff", fig4, units="in", width = 6.5, height = 4, device='tiff', dpi=300)
fig4
knitr::opts_chunk$set(echo = TRUE)
#plots
library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(ggpubr)
library(cowplot)
library(readxl)
#stats
library(lme4)
library(lmerTest)
library(MuMIn)
ggthemr('flat')
qpcr_data <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_011623.csv")
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
ind_ds <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
eardata <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/EarDaysToClose.xlsx")
stability <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/stabilitybycage.csv")
qpcr_data <- left_join(qpcr_data, sex_id[,c(4,6,15)], by="AnimalID")
qpcr_data <- left_join(qpcr_data, ind_ds[,2:5], by="AnimalID")
qpcr_data <- left_join(qpcr_data, eardata, by="AnimalID")
qpcr_data <- left_join(qpcr_data, stability, by="AnimalID")
qpcr_data$Sex <- as.factor(qpcr_data$Sex)
qpcr_data$Cage.x <- as.factor(qpcr_data$Cage.x)
qpcr_data$GrpSize <- as.factor(qpcr_data$GrpSize)
qpcr_data$dom_status_ds <- as.factor(qpcr_data$dom_status_ds)
qpcr_data$stab_status <- factor(qpcr_data$stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable"))
Cyp11a1_m_f <- lm(GeneExpRat ~ Sex + ds + stab_status2 + ds*stab_status2, filter(qpcr_data, target.x=="Cyp11a1"))
Star_m_f <- lm(GeneExpRat ~ Sex + ds + stab_status2 + ds*stab_status2, filter(qpcr_data, target.x=="StAR"))
Nr5a1_m_f <- lm(GeneExpRat ~ Sex + ds + stab_status2 + ds*stab_status2, filter(qpcr_data, target.x=="Nrb01"))
Nrb01_m_f <- lm(GeneExpRat ~ Sex + ds + stab_status2 + ds*stab_status2, filter(qpcr_data, target.x=="Nr5a1"))
Cyp11b1_m_f <- lm(GeneExpRat ~  Sex + ds + stab_status2 + ds*stab_status2, filter(qpcr_data, target.x=="Cyp11b1"))
print("Cyp11a1")
anova(Cyp11a1_m_f)
summary(Cyp11a1_m_f)
print("Star")
anova(Star_m_f)
r.squaredGLMM(Star_m_f)
print("Nr5a1")
anova(Nr5a1_m_f)
print("Nrb01")
anova(Nrb01_m_f)
summary(Nrb01_m_f)
print("Cyp11b1")
anova(Cyp11b1_m_f)
summary(Cyp11b1_m_f)
cyp11b1 <- qpcr_data %>%
filter(target.x != "GAPDH")
cyp_plot <- ggplot(cyp11b1, aes(target.x, GeneExpRat, fill=Sex, color=Sex))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("") + ylab("Relative ∆Ct to ActinB")+
theme(text = element_text(size = 9))
cyp_plot
Nr5a1 <- qpcr_data %>%
filter(target.x == "Nr5a1")
Nr_plot <- ggplot(Nr5a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=4)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1.5)+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Nr5a1 \nRelative ∆Ct to ActinB")+
labs(color="Type of \n Dom. Relationship")+
annotate("text", x = c(-1,1), y = c(.95,.95), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Nr_plot
Cyp11a1 <- qpcr_data %>%
filter(target.x == "Cyp11a1")
Cypa_plot <- ggplot(Cyp11a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=4)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1.5)+
scale_y_continuous(limits=c(1,1.3), breaks=c(1, 1.1, 1.2, 1.3))+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Cyp11a1 \nRelative ∆Ct to ActinB")+
labs(color="Type of \n Dom. Relationship")+
annotate("text", x = c(-1.5,1.5), y = c(1,1), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Cypa_plot
Nrb01 <- qpcr_data %>%
filter(target.x == "Nrb01")
nrb_plot <- ggplot(Nrb01, aes(ds, GeneExpRat))+
geom_point(aes(color=ds), size=4)+
geom_smooth(method=lm, se=FALSE, size=1.5, color="black")+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_gsea()+
xlab("David's Score") + ylab("Nr0b1 \nRelative ∆Ct to ActinB")+
annotate("text", x = c(-1.5,1.5), y = c(.95,.95), label = c("more subordinate","more dominant"))+
labs(color="David's \nscore")+
theme(text = element_text(size = 9), legend.position="none")
nrb_plot
cypb <- qpcr_data %>%
filter(target.x == "Cyp11b1")
cypb_plot <- ggplot(cypb, aes(stab_status, GeneExpRat, color=stab_status, fill=stab_status))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("Type of Dom. Relationship") + ylab("Cyp11b1 \nRelative ∆Ct to ActinB")+
theme(text = element_text(size = 9), legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
cypb_plot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots_rev.tiff", qplot, units="in", width = 6.5, height =6.5, device='tiff', dpi=300)
qplot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots_rev.tiff", qplot, units="in", width = 4, height =6.5, device='tiff', dpi=300)
qplot
Cyp11a1 <- qpcr_data %>%
filter(target.x == "Cyp11a1")
Cypa_plot <- ggplot(Cyp11a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=1)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1.5)+
scale_y_continuous(limits=c(1,1.3), breaks=c(1, 1.1, 1.2, 1.3))+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Cyp11a1 \nRelative ∆Ct to ActinB")+
labs(color="Type of \n Dom. Relationship")+
annotate("text", x = c(-1.5,1.5), y = c(1,1), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Cypa_plot
Nrb01 <- qpcr_data %>%
filter(target.x == "Nrb01")
nrb_plot <- ggplot(Nrb01, aes(ds, GeneExpRat))+
geom_point(aes(color=ds), size=1)+
geom_smooth(method=lm, se=FALSE, size=1.5, color="black")+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_gsea()+
xlab("David's Score") + ylab("Nr0b1 \nRelative ∆Ct to ActinB")+
annotate("text", x = c(-1.5,1.5), y = c(.95,.95), label = c("more subordinate","more dominant"))+
labs(color="David's \nscore")+
theme(text = element_text(size = 9), legend.position="none")
nrb_plot
cypb <- qpcr_data %>%
filter(target.x == "Cyp11b1")
cypb_plot <- ggplot(cypb, aes(stab_status, GeneExpRat, color=stab_status, fill=stab_status))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("Type of Dom. Relationship") + ylab("Cyp11b1 \nRelative ∆Ct to ActinB")+
theme(text = element_text(size = 9), legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
cypb_plot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots_rev.tiff", qplot, units="in", width = 4, height =8, device='tiff', dpi=300)
qplot
Nrb01 <- qpcr_data %>%
filter(target.x == "Nrb01")
nrb_plot <- ggplot(Nrb01, aes(ds, GeneExpRat))+
geom_point(aes(color=ds), size=1)+
geom_smooth(method=lm, se=FALSE, size=1, color="black")+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_gsea()+
xlab("David's Score") + ylab("Nr0b1 \nRelative ∆Ct to ActinB")+
annotate("text", x = c(-1.5,1.5), y = c(.95,.95), label = c("more subordinate","more dominant"))+
labs(color="David's \nscore")+
theme(text = element_text(size = 9), legend.position="none")
nrb_plot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots_rev.tiff", qplot, units="in", width = 4, height =8, device='tiff', dpi=300)
qplot
Cyp11a1 <- qpcr_data %>%
filter(target.x == "Cyp11a1")
Cypa_plot <- ggplot(Cyp11a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=2)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1)+
scale_y_continuous(limits=c(1,1.3), breaks=c(1, 1.1, 1.2, 1.3))+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Cyp11a1 \nRelative ∆Ct to ActinB")+
labs(color="Type of \n Dom. Relationship")+
annotate("text", x = c(-1.5,1.5), y = c(1,1), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Cypa_plot
Nrb01 <- qpcr_data %>%
filter(target.x == "Nrb01")
nrb_plot <- ggplot(Nrb01, aes(ds, GeneExpRat))+
geom_point(aes(color=ds), size=2)+
geom_smooth(method=lm, se=FALSE, size=1, color="black")+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_gsea()+
xlab("David's Score") + ylab("Nr0b1 \nRelative ∆Ct to ActinB")+
annotate("text", x = c(-1.5,1.5), y = c(.95,.95), label = c("more subordinate","more dominant"))+
labs(color="David's \nscore")+
theme(text = element_text(size = 9), legend.position="none")
nrb_plot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots_rev.tiff", qplot, units="in", width = 4, height =8, device='tiff', dpi=300)
qplot
library(tidyverse)
library(ggalluvial)
library(readxl)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(cowplot)
library(lme4)
library(lmerTest)
week_rank <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebweek_edited.csv")
week_rank$Cage <- as.factor(week_rank$Cage)
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet3")
sex_id$Cage <- as.factor(sex_id$Cage)
week_rank <- left_join(week_rank, sex_id, by="Cage")
week_rank <- rename(week_rank, "Opponent.1"=AnimalID)
dumcage <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
dumcage <- dumcage[,c(1,4)]
dumcage <- distinct(dumcage)
dumcage$Cage <- as.factor(dumcage$Cage)
week_rank <- left_join(week_rank, dumcage, by="Cage")
cumm_dom <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
cumm_dom <- rename(cumm_dom, "cumm_dom_status"=dom_status_ds)
cumm_dom <- rename(cumm_dom, "Opponent.1"=AnimalID)
week_rank <- left_join(week_rank, cumm_dom[,c(2,5)], by="Opponent.1")
week_rank <- week_rank %>%
mutate(dom_status_num=case_when(dom_status_ds=="Dominant"~3,
dom_status_ds=="Subordinate"~1,
dom_status_ds=="Subdominant"~2,
dom_status_ds=="Unmeasurable"~0))
stability <- week_rank %>%
select(Opponent.1, Cage, DumCage, Sex, Week, dom_status_num) %>%
spread(Week, dom_status_num) %>%
mutate(Week12=ifelse(`Week1`==`Week2`,1,0))%>%
mutate(Week23=ifelse(`Week2`==`Week3`,1,0)) %>%
mutate(stab_status=ifelse(Week12+Week23==2,"Enforced stable","Unstable"))
stability2 <- stability %>%
mutate(stab_status2=ifelse(`Week1`==0 & stab_status=="Unstable"
|`Week2`==0 & stab_status=="Unstable"
| `Week3`==0 & stab_status=="Unstable","Unenforced stable",stab_status))
week_rank_stab <- stability2 %>%
select(Opponent.1, stab_status2) %>%
left_join(week_rank, by="Opponent.1") %>%
mutate(stab_status2=ifelse(cumm_dom_status=="Unmeasurable","Unmeasurable",stab_status2)) %>%
mutate(stab_status2=ordered(stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable")))
river_data <- week_rank_stab %>%
mutate(dom_status_abb=case_when(dom_status_ds=="Dominant"~"Dom",
dom_status_ds=="Subordinate"~"Sub",
dom_status_ds=="Subdominant"~"Subd",
dom_status_ds=="Unmeasurable"~"Unm"))%>%
select(Opponent.1, Cage, DumCage, stab_status2, Trt, Sex, GrpSize, Age, Week, dom_status_abb) %>%
spread(Week, dom_status_abb)
river_data$Week1 <- as.factor(river_data$Week1)
river_data$Week2 <- as.factor(river_data$Week2)
river_data$Week3 <- as.factor(river_data$Week3)
river_data$Trt <- factor(river_data$Trt, levels=c("YFD", "YMD", "OFD", "YMT"))
river_data$stab_status <- factor(river_data$stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable"))
fig2 <- ggplot(river_data, aes(axis1=Week1, axis2=Week2, axis3=Week3))+
geom_alluvium(aes(fill=stab_status2, text=DumCage))+
geom_text(stat="alluvium", aes(label=DumCage), hjust=0, nudge_x=0.2, size=3)+
geom_stratum() +
geom_text(stat="stratum", aes(label=after_stat(stratum)), size=2)+
scale_x_discrete(limits=c("1", "2", "3"), expand=c(.05,.05))+
xlab("")+
scale_y_continuous(expand=c(0,0), breaks = seq(1,15,1))+
scale_fill_npg()+
labs(fill="Type of \n Dominance Relationship")+
theme(legend.position = "none", plot.title = element_text(hjust = 0.5), axis.text.y=element_blank(), axis.ticks.y=element_blank())+
facet_wrap(~Trt, scales="free")
fig2
rank_stab <- week_rank_stab %>%
select(Opponent.1, Cage, stab_status2) %>%
rename("AnimalID"=Opponent.1) %>%
distinct()
sex_id2 <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
sex_id2 <- distinct(sex_id2[,c(3,6,15)])
rank_stab <- left_join(rank_stab, sex_id2, by="AnimalID")
rank_stab <- left_join(rank_stab, dumcage, by="Cage")
rank_stab <- distinct(rank_stab)
rank_stab$stab_status2 <- factor(rank_stab$stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable"))
agestab_plot <- ggplot(rank_stab, aes(stab_status2, AgeAtTest, color=stab_status2, label=DumCage))+
geom_jitter(size=1.5) +
scale_color_npg()+
xlab("") + ylab("Age at experiment d0")+
labs(color="Type of \n Dom. Relationship")+
theme(text = element_text(size = 10), axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
agestab_plot
rank_stab <- week_rank_stab %>%
select(Opponent.1, Cage, stab_status2) %>%
rename("AnimalID"=Opponent.1) %>%
distinct()
sex_id2 <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
sex_id2 <- distinct(sex_id2[,c(3,6,15)])
rank_stab <- left_join(rank_stab, sex_id2, by="AnimalID")
rank_stab <- left_join(rank_stab, dumcage, by="Cage")
rank_stab <- distinct(rank_stab)
rank_stab$stab_status2 <- factor(rank_stab$stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable"))
agestab_plot <- ggplot(rank_stab, aes(stab_status2, AgeAtTest, color=stab_status2, label=DumCage))+
geom_jitter(size=1.5) +
scale_color_npg()+
xlab("") + ylab("Age at experiment d0")+
labs(color="Stability Category")+
theme(text = element_text(size = 10), axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
agestab_plot
figx <- plot_grid(
fig2, agestab_plot,
labels="AUTO", ncol=2,
label_size = 12
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig2_stab_plots.tiff", figx, units="in", width = 7, height = 4, device='tiff', dpi=300)
figx
knitr::opts_chunk$set(echo = TRUE)
#plots
library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(ggpubr)
library(cowplot)
library(readxl)
#stats
library(psych)
library(lme4)
library(lmerTest)
library(MuMIn)
ggthemr('flat')
eardata <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/EarDaysToClose.xlsx")
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
ind_ds <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
stability <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/stabilitybycage.csv")
eardata <- left_join(eardata, sex_id[,1:16], by="AnimalID")
eardata <- left_join(eardata, ind_ds, by="AnimalID")
eardata <- left_join(eardata, stability, by="AnimalID")
eardata$Sex <- as.factor(eardata$Sex)
eardata$Cage.x <- as.factor(eardata$Cage.x)
eardata$GrpSize <- as.factor(eardata$GrpSize)
eardata$dom_status_ds <- as.factor(eardata$dom_status_ds)
eardata$stab_status2 <- factor(eardata$stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable"))
earplot <- ggplot(eardata, aes(ds, DaysToClose))+
geom_point(aes(color=stab_status2), size=1)+
geom_smooth(aes(color=stab_status2), method=lm, se=FALSE, size=1)+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Days to close ear")+
annotate("text", x = c(-2,2), y = c(2,2), label = c("more subordinate","more dominant"))+
labs(color="Stability Category")+
theme(text = element_text(size = 10))
earplot
ageplot <- ggplot(eardata, aes(AgeAtTest, DaysToClose))+
geom_point(aes(color=stab_status2), size=4)+
scale_color_npg()+
xlab("Age at experiment d0") + ylab("Days to close ear")+
labs(color="Stability Category")
ageplot
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/fig5_ear.tiff", earplot, units="in", width = 6, height = 3, device='tiff', dpi=300)
knitr::opts_chunk$set(echo = TRUE)
#plots
library(tidyverse)
library(ggplot2)
library(ggbeeswarm)
library(ggthemr) #devtools::install_github('Mikata-Project/ggthemr')
library(ggsci)
library(ggpubr)
library(cowplot)
library(readxl)
#stats
library(lme4)
library(lmerTest)
library(MuMIn)
ggthemr('flat')
qpcr_data <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/qpcr_combined_011623.csv")
sex_id <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/AcomysDomRegen_Inventory.xlsx", sheet = "Sheet1")
ind_ds <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/dscorebyanimal_edited.csv")
eardata <- read_excel("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/EarDaysToClose.xlsx")
stability <- read.csv("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/Data/stabilitybycage.csv")
qpcr_data <- left_join(qpcr_data, sex_id[,c(4,6,15)], by="AnimalID")
qpcr_data <- left_join(qpcr_data, ind_ds[,2:5], by="AnimalID")
qpcr_data <- left_join(qpcr_data, eardata, by="AnimalID")
qpcr_data <- left_join(qpcr_data, stability, by="AnimalID")
qpcr_data$Sex <- as.factor(qpcr_data$Sex)
qpcr_data$Cage.x <- as.factor(qpcr_data$Cage.x)
qpcr_data$GrpSize <- as.factor(qpcr_data$GrpSize)
qpcr_data$dom_status_ds <- as.factor(qpcr_data$dom_status_ds)
qpcr_data$stab_status <- factor(qpcr_data$stab_status2, levels=c("Enforced stable", "Unstable", "Unenforced stable", "Unmeasurable"))
Nr5a1 <- qpcr_data %>%
filter(target.x == "Nr5a1")
Nr_plot <- ggplot(Nr5a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=4)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1.5)+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Nr5a1 \nRelative ∆Ct to ActinB")+
labs(color="Type of \n Dom. Relationship")+
annotate("text", x = c(-1,1), y = c(.95,.95), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Nr_plot
Cyp11a1 <- qpcr_data %>%
filter(target.x == "Cyp11a1")
Cypa_plot <- ggplot(Cyp11a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=2)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1)+
scale_y_continuous(limits=c(1,1.3), breaks=c(1, 1.1, 1.2, 1.3))+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Cyp11a1 \nRelative ∆Ct to ActinB")+
labs(color="Type of \n Dom. Relationship")+
annotate("text", x = c(-1.5,1.5), y = c(1,1), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Cypa_plot
Cyp11a1 <- qpcr_data %>%
filter(target.x == "Cyp11a1")
Cypa_plot <- ggplot(Cyp11a1, aes(ds, GeneExpRat))+
geom_point(aes(color=stab_status), size=2)+
geom_smooth(aes(color=stab_status), method=lm, se=FALSE, size=1)+
scale_y_continuous(limits=c(1,1.3), breaks=c(1, 1.1, 1.2, 1.3))+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_npg()+
xlab("David's Score") + ylab("Cyp11a1 \nRelative ∆Ct to ActinB")+
labs(color="Stability Category")+
annotate("text", x = c(-1.5,1.5), y = c(1,1), label = c("more subordinate","more dominant"))+
theme(text = element_text(size = 9), legend.position="none")
Cypa_plot
Nrb01 <- qpcr_data %>%
filter(target.x == "Nrb01")
nrb_plot <- ggplot(Nrb01, aes(ds, GeneExpRat))+
geom_point(aes(color=ds), size=2)+
geom_smooth(method=lm, se=FALSE, size=1, color="black")+
scale_x_continuous(limits=c(-3,3), breaks=c(-3,-2,-1,0,1,2,3))+
scale_color_gsea()+
xlab("David's Score") + ylab("Nr0b1 \nRelative ∆Ct to ActinB")+
annotate("text", x = c(-1.5,1.5), y = c(.95,.95), label = c("more subordinate","more dominant"))+
labs(color="David's \nscore")+
theme(text = element_text(size = 9), legend.position="none")
nrb_plot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
cypb <- qpcr_data %>%
filter(target.x == "Cyp11b1")
cypb_plot <- ggplot(cypb, aes(stab_status, GeneExpRat, color=stab_status, fill=stab_status))+
geom_dotplot(binaxis='y', stackdir='center', position=position_dodge(0.75), binwidth = 0.0125)+
stat_summary(fun=median, size=0.5, geom="crossbar", width=0.5, position=position_dodge(width=0.75))+
scale_fill_npg()+
scale_color_npg()+
xlab("Stability Category") + ylab("Cyp11b1 \nRelative ∆Ct to ActinB")+
theme(text = element_text(size = 9), legend.position="none", axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
cypb_plot
qplot <- plot_grid(
Cypa_plot, nrb_plot, cypb_plot,
labels="AUTO",  ncol=1,
label_size = 20
)
ggsave("/Users/justinvarholick/Documents/GitHub/AcomysDominance_2022_Data_Results/R generated figures/Fig6_qpcr_plots_rev.tiff", qplot, units="in", width = 4, height =8, device='tiff', dpi=300)
qplot
